!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){t.exports=i.p+"death.png"},function(t,e,i){"use strict";i.r(e);var n=["width","height","context","render","update","children","anchor","opacity","rotation","scaleX","scaleY"],r=["image","width","height"],o=["text","textAlign","lineHeight","font"],s=["id","name","objects","context","cullObjects","cullFunction","sortFunction"];function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t,e){if(null==t)return{};var i,n,r=function(t,e){if(null==t)return{};var i,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)i=o[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)i=o[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=d(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}}).apply(this,arguments)}function d(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}function y(t){var e=b();return function(){var i,n=v(t);if(e){var r=v(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p(this,i)}}function p(t,e){if(e&&("object"===x(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==i)return;var n,r,o=[],s=!0,h=!1;try{for(i=i.call(t);!(s=(n=i.next()).done)&&(o.push(n.value),!e||o.length!==e);s=!0);}catch(t){h=!0,r=t}finally{try{s||null==i.return||i.return()}finally{if(h)throw r}}return o}(t,e)||m(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){if(t){if("string"==typeof t)return w(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e,i){return(_=b()?Reflect.construct.bind():function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&j(r,i.prototype),r}).apply(null,arguments)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function j(t,e){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function A(t,e,i){return e&&O(t.prototype,e),i&&O(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var S=function(){},P="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);";function E(t,e){var i=e.parentNode;if(t.setAttribute("data-kontra",""),i){var n=i.querySelector("[data-kontra]:last-of-type")||e;i.insertBefore(t,n.nextSibling)}else document.body.appendChild(t)}function H(t,e){var i=t.indexOf(e);if(-1!=i)return t.splice(i,1),!0}var M,R,z={};function Y(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];(z[t]||[]).map((function(t){return t.apply(void 0,i)}))}var I={get:function(t,e){return"_proxy"==e||S}};function W(){return M}function C(){return R}function D(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.contextless,n=void 0!==i&&i;if(M=document.getElementById(t)||t||document.querySelector("canvas"),n&&(M=M||new Proxy({},I)),!M)throw Error("You must provide a canvas element for the game");return(R=M.getContext("2d")||new Proxy({},I)).imageSmoothingEnabled=!1,Y("init"),{canvas:M,context:R}}var T=function(){function t(e){var i=e.spriteSheet,n=e.frames,r=e.frameRate,o=e.loop,s=void 0===o||o;k(this,t),this.spriteSheet=i,this.frames=n,this.frameRate=r,this.loop=s;var h=i.frame,a=h.width,c=h.height,u=h.margin,l=void 0===u?0:u;this.width=a,this.height=c,this.margin=l,this._f=0,this._a=0}return A(t,[{key:"clone",value:function(){return new t(this)}},{key:"reset",value:function(){this._f=0,this._a=0}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/60;if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}},{key:"render",value:function(t){var e=t.x,i=t.y,n=t.width,r=void 0===n?this.width:n,o=t.height,s=void 0===o?this.height:o,h=t.context,a=void 0===h?C():h,c=this.frames[this._f]/this.spriteSheet._f|0,u=this.frames[this._f]%this.spriteSheet._f|0;a.drawImage(this.spriteSheet.image,u*this.width+(2*u+1)*this.margin,c*this.height+(2*c+1)*this.margin,this.width,this.height,e,i,r,s)}}]),t}();function L(){return _(T,Array.prototype.slice.call(arguments))}function F(t,e){var i=Math.sin(e),n=Math.cos(e);return{x:t.x*n-t.y*i,y:t.x*i+t.y*n}}function X(t,e,i){return Math.min(Math.max(t,i),e)}function N(t,e){var i=g([t,e].map((function(t){return B(t)})),2);return t=i[0],e=i[1],t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function B(t){var e=t.world||t,i=e.x,n=void 0===i?0:i,r=e.y,o=void 0===r?0:r,s=e.width,h=e.height;return t.mapwidth&&(s=t.mapwidth,h=t.mapheight),t.anchor&&(n-=s*t.anchor.x,o-=h*t.anchor.y),s<0&&(n+=s,s*=-1),h<0&&(o+=h,h*=-1),{x:n,y:o,width:s,height:h}}var q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};k(this,t),this.x=e,this.y=i,n._c&&(this.clamp(n._a,n._b,n._d,n._e),this.x=e,this.y=i)}return A(t,[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y,this)}},{key:"subtract",value:function(e){return new t(this.x-e.x,this.y-e.y,this)}},{key:"scale",value:function(e){return new t(this.x*e,this.y*e)}},{key:"normalize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.length();return new t(this.x/e,this.y/e)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"length",value:function(){return Math.hypot(this.x,this.y)}},{key:"distance",value:function(t){return Math.hypot(this.x-t.x,this.y-t.y)}},{key:"angle",value:function(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}},{key:"clamp",value:function(t,e,i,n){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=n}},{key:"x",get:function(){return this._x},set:function(t){this._x=this._c?X(this._a,this._d,t):t}},{key:"y",get:function(){return this._y},set:function(t){this._y=this._c?X(this._b,this._e,t):t}}]),t}();function U(){return _(q,Array.prototype.slice.call(arguments))}var G=function(t){f(i,t);var e=y(i);function i(){return k(this,i),e.apply(this,arguments)}return A(i,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,r=void 0===e?0:e,o=t.height,s=void 0===o?0:o,h=t.context,c=void 0===h?C():h,d=t.render,f=void 0===d?this.draw:d,y=t.update,p=void 0===y?this.advance:y,g=t.children,m=void 0===g?[]:g,w=t.anchor,x=void 0===w?{x:0,y:0}:w,_=t.opacity,b=void 0===_?1:_,j=t.rotation,k=void 0===j?0:j,O=t.scaleX,A=void 0===O?1:O,S=t.scaleY,P=void 0===S?1:S,E=u(t,n);this._c=[],l(v(i.prototype),"init",this).call(this,a({width:r,height:s,context:c,anchor:x,opacity:b,rotation:k,scaleX:A,scaleY:P},E)),this._di=!0,this._uw(),this.addChild(m),this._rf=f,this._uf=p}},{key:"update",value:function(t){this._uf(t),this.children.map((function(e){return e.update&&e.update(t)}))}},{key:"render",value:function(){var t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);var e=-this.width*this.anchor.x,i=-this.height*this.anchor.y;(e||i)&&t.translate(e,i),this.context.globalAlpha=this.opacity,this._rf(),(e||i)&&t.translate(-e,-i),this.children.map((function(t){return t.render&&t.render()})),t.restore()}},{key:"draw",value:function(){}},{key:"_pc",value:function(){this._uw(),this.children.map((function(t){return t._pc()}))}},{key:"x",get:function(){return this.position.x},set:function(t){this.position.x=t,this._pc()}},{key:"y",get:function(){return this.position.y},set:function(t){this.position.y=t,this._pc()}},{key:"width",get:function(){return this._w},set:function(t){this._w=t,this._pc()}},{key:"height",get:function(){return this._h},set:function(t){this._h=t,this._pc()}},{key:"_uw",value:function(){if(this._di){var t=this.parent||{},e=t._wx,i=void 0===e?0:e,n=t._wy,r=void 0===n?0:n,o=t._wo,s=void 0===o?1:o,h=t._wr,a=void 0===h?0:h,c=t._wsx,u=void 0===c?1:c,l=t._wsy,d=void 0===l?1:l;this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=s*this.opacity,this._wsx=u*this.scaleX,this._wsy=d*this.scaleY,this._wx=this._wx*u,this._wy=this._wy*d,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=a+this.rotation;var f=F({x:this._wx,y:this._wy},a),y=f.x,p=f.y;this._wx=y,this._wy=p,this._wx+=i,this._wy+=r}}},{key:"world",get:function(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}},{key:"children",get:function(){return this._c},set:function(t){this.removeChild(this._c),this.addChild(t)}},{key:"addChild",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.flat().map((function(e){t.children.push(e),e.parent=t,e._pc=e._pc||S,e._pc()}))}},{key:"removeChild",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.flat().map((function(e){H(t.children,e)&&(e.parent=null,e._pc())}))}},{key:"opacity",get:function(){return this._opa},set:function(t){this._opa=t,this._pc()}},{key:"rotation",get:function(){return this._rot},set:function(t){this._rot=t,this._pc()}},{key:"setScale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.scaleX=t,this.scaleY=e}},{key:"scaleX",get:function(){return this._scx},set:function(t){this._scx=t,this._pc()}},{key:"scaleY",get:function(){return this._scy},set:function(t){this._scy=t,this._pc()}}]),i}(function(){function t(e){return k(this,t),this.init(e)}return A(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.position=U(),this.velocity=U(),this.acceleration=U(),this.ttl=1/0,Object.assign(this,t)}},{key:"update",value:function(t){this.advance(t)}},{key:"advance",value:function(t){var e=this.acceleration;t&&(e=e.scale(t)),this.velocity=this.velocity.add(e);var i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--}},{key:"dx",get:function(){return this.velocity.x},set:function(t){this.velocity.x=t}},{key:"dy",get:function(){return this.velocity.y},set:function(t){this.velocity.y=t}},{key:"ddx",get:function(){return this.acceleration.x},set:function(t){this.acceleration.x=t}},{key:"ddy",get:function(){return this.acceleration.y},set:function(t){this.acceleration.y=t}},{key:"isAlive",value:function(){return this.ttl>0}},{key:"_pc",value:function(){}}]),t}());function $(){return _(G,Array.prototype.slice.call(arguments))}var K=function(t){f(i,t);var e=y(i);function i(){return k(this,i),e.apply(this,arguments)}return A(i,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.image,n=t.width,o=void 0===n?e?e.width:void 0:n,s=t.height,h=void 0===s?e?e.height:void 0:s,c=u(t,r);l(v(i.prototype),"init",this).call(this,a({image:e,width:o,height:h},c))}},{key:"animations",get:function(){return this._a},set:function(t){var e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}},{key:"playAnimation",value:function(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}},{key:"advance",value:function(t){l(v(i.prototype),"advance",this).call(this,t),this.currentAnimation&&this.currentAnimation.update(t)}},{key:"draw",value:function(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}]),i}(G);function J(){return _(K,Array.prototype.slice.call(arguments))}var Q=/(\d+)(\w+)/;var V=function(t){f(i,t);var e=y(i);function i(){return k(this,i),e.apply(this,arguments)}return A(i,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.text,n=void 0===e?"":e,r=t.textAlign,s=void 0===r?"":r,h=t.lineHeight,c=void 0===h?1:h,d=t.font,f=void 0===d?C().font:d,y=u(t,o);n=""+n,l(v(i.prototype),"init",this).call(this,a({text:n,textAlign:s,lineHeight:c,font:f},y)),this._p()}},{key:"width",get:function(){return this._w},set:function(t){this._d=!0,this._w=t,this._fw=t}},{key:"text",get:function(){return this._t},set:function(t){this._d=!0,this._t=""+t}},{key:"font",get:function(){return this._f},set:function(t){var e,i,n;this._d=!0,this._f=t,this._fs=(e=t,i=e.match(Q),n=+i[1],{size:n,unit:i[2],computed:n}).computed}},{key:"lineHeight",get:function(){return this._lh},set:function(t){this._d=!0,this._lh=t}},{key:"render",value:function(){this._d&&this._p(),l(v(i.prototype),"render",this).call(this)}},{key:"_p",value:function(){var t=this;this._s=[],this._d=!1;var e=this.context;if(e.font=this.font,!this._s.length&&this._fw){for(var i=this.text.split(" "),n=0,r=2;r<=i.length;r++){var o=i.slice(n,r).join(" ");e.measureText(o).width>this._fw&&(this._s.push(i.slice(n,r-1).join(" ")),n=r-1)}this._s.push(i.slice(n,r).join(" "))}if(!this._s.length&&this.text.includes("\n")){var s=0;this.text.split("\n").map((function(i){t._s.push(i),s=Math.max(s,e.measureText(i).width)})),this._w=this._fw||s}this._s.length||(this._s.push(this.text),this._w=this._fw||e.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}},{key:"draw",value:function(){var t,e=this,i=this.textAlign,n=this.context;i=this.textAlign||("rtl"==n.canvas.dir?"right":"left"),t="right"==i?this.width:"center"==i?this.width/2|0:0,this._s.map((function(r,o){n.textBaseline="top",n.textAlign=i,n.fillStyle=e.color,n.font=e.font,n.fillText(r,t,e._fs*e.lineHeight*o)}))}}]),i}(G);function Z(){return _(V,Array.prototype.slice.call(arguments))}new WeakMap;function tt(t){var e=t.canvas;t.clearRect(0,0,e.width,e.height)}function et(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fps,i=void 0===e?60:e,n=t.clearCanvas,r=void 0===n||n,o=t.update,s=void 0===o?S:o,h=t.render,a=t.context,c=void 0===a?C():a,u=t.blur,l=void 0!==u&&u;if(!h)throw Error("You must provide a render() function");var d,f,y,p,v,g=0,m=1e3/i,w=1/i,x=r?tt:S,_=!0;function b(){if(f=requestAnimationFrame(b),_&&(y=performance.now(),p=y-d,d=y,!(p>1e3))){for(Y("tick"),g+=p;g>=m;)v.update(w),g-=m;x(c),v.render()}}return l||(window.addEventListener("focus",(function(){_=!0})),window.addEventListener("blur",(function(){_=!1}))),v={update:s,render:h,isStopped:!0,start:function(){d=performance.now(),this.isStopped=!1,requestAnimationFrame(b)},stop:function(){this.isStopped=!0,cancelAnimationFrame(f)},_frame:b,set _last(t){d=t}}}var it={},nt={},rt={},ot={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function st(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,e=arguments.length>1?arguments[1]:void 0;t._pd&&e.preventDefault(),t(e)}function ht(t){var e=ot[t.code],i=it[e];rt[e]=!0,st(i,t)}function at(t){var e=ot[t.code],i=nt[e];rt[e]=!1,st(i,t)}function ct(){rt={}}function ut(){var t;for(t=0;t<26;t++)ot["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)ot["Digit"+t]=ot["Numpad"+t]=""+t;window.addEventListener("keydown",ht),window.addEventListener("keyup",at),window.addEventListener("blur",ct)}function lt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.handler,r=void 0===n?"keydown":n,o=i.preventDefault,s=void 0===o||o,h="keydown"==r?it:nt;e._pd=s,[].concat(t).map((function(t){return h[t]=e}))}function dt(t){return!!rt[t]}var ft=function(){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.create,r=i.maxSize,o=void 0===r?1024:r;if(k(this,t),!n||!(e=n())||!(e.update&&e.init&&e.isAlive&&e.render))throw Error("Must provide create() function which returns an object with init(), update(), render(), and isAlive() functions");this._c=n,this.objects=[n()],this.size=0,this.maxSize=o}return A(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.size==this.objects.length){if(this.size==this.maxSize)return;for(var e=0;e<this.size&&this.objects.length<this.maxSize;e++)this.objects.push(this._c())}var i=this.objects[this.size];return this.size++,i.init(t),i}},{key:"getAliveObjects",value:function(){return this.objects.slice(0,this.size)}},{key:"clear",value:function(){this.size=this.objects.length=0,this.objects.push(this._c())}},{key:"update",value:function(t){for(var e,i=!1,n=this.size;n--;)(e=this.objects[n]).update(t),e.isAlive()||(i=!0,this.size--);i&&this.objects.sort((function(t,e){return e.isAlive()-t.isAlive()}))}},{key:"render",value:function(){for(var t=this.size;t--;)this.objects[t].render()}}]),t}();function yt(){return _(ft,Array.prototype.slice.call(arguments))}function pt(t){var e=[];return t._dn?e.push(t._dn):t.children&&t.children.map((function(t){e=e.concat(pt(t))})),e}var vt=function(){function t(e){var i=e.id,n=e.name,r=void 0===n?i:n,o=e.objects,h=void 0===o?[]:o,c=e.context,l=void 0===c?C():c,d=e.cullObjects,f=void 0===d||d,y=e.cullFunction,p=void 0===y?N:y,v=e.sortFunction,g=u(e,s);k(this,t),this._o=[];var m=l.canvas,w=this._dn=document.createElement("section");w.tabIndex=-1,w.style=P,w.id=i,w.setAttribute("aria-label",r),E(w,m),Object.assign(this,a({id:i,name:r,context:l,cullObjects:f,cullFunction:p,sortFunction:v},g));var x=m.width,_=m.height,b=x/2,j=_/2;this.camera=$({x:b,y:j,width:x,height:_,context:l,centerX:b,centerY:j,anchor:{x:.5,y:.5},render:this._rf.bind(this)}),this.add(h)}return A(t,[{key:"objects",get:function(){return this._o},set:function(t){this.remove(this._o),this.add(t)}},{key:"add",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.flat().map((function(e){t._o.push(e),pt(e).map((function(e){t._dn.appendChild(e)}))}))}},{key:"remove",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.flat().map((function(e){H(t._o,e),pt(e).map((function(e){E(e,t.context)}))}))}},{key:"show",value:function(){this.hidden=this._dn.hidden=!1;var t=this._o.find((function(t){return t.focus}));t?t.focus():this._dn.focus(),this.onShow()}},{key:"hide",value:function(){this.hidden=this._dn.hidden=!0,this.onHide()}},{key:"destroy",value:function(){this._dn.remove(),this._o.map((function(t){return t.destroy&&t.destroy()}))}},{key:"lookAt",value:function(t){var e=t.world||t,i=e.x,n=e.y;this.camera.x=i,this.camera.y=n}},{key:"update",value:function(t){this.hidden||this._o.map((function(e){return e.update&&e.update(t)}))}},{key:"_rf",value:function(){var t=this._o,e=this.context,i=this._sx,n=this._sy,r=this.camera,o=this.sortFunction,s=this.cullObjects,h=this.cullFunction;e.translate(i,n);var a=t;s&&(a=a.filter((function(t){return h(r,t)}))),o&&a.sort(o),a.map((function(t){return t.render&&t.render()}))}},{key:"render",value:function(){if(!this.hidden){var t=this.context,e=this.camera,i=e.x,n=e.y,r=e.centerX,o=e.centerY;t.save(),this._sx=r-i,this._sy=o-n,t.translate(this._sx,this._sy),e.render(),t.restore()}}},{key:"onShow",value:function(){}},{key:"onHide",value:function(){}}]),t}();function gt(){return _(vt,Array.prototype.slice.call(arguments))}function mt(t){if(+t==t)return t;var e=[],i=t.split(".."),n=+i[0],r=+i[1],o=n;if(n<r)for(;o<=r;o++)e.push(o);else for(;o>=r;o--)e.push(o);return e}var wt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.image,n=e.frameWidth,r=e.frameHeight,o=e.frameMargin,s=e.animations;if(k(this,t),!i)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=i,this.frame={width:n,height:r,margin:o},this._f=i.width/n|0,this.createAnimations(s)}return A(t,[{key:"createAnimations",value:function(t){var e,i;for(i in t){var n=t[i],r=n.frames,o=n.frameRate,s=n.loop;if(e=[],null==r)throw Error("Animation "+i+" must provide a frames property");[].concat(r).map((function(t){e=e.concat(mt(t))})),this.animations[i]=L({spriteSheet:this,frames:e,frameRate:o,loop:s})}}}]),t}();function xt(){return _(wt,Array.prototype.slice.call(arguments))}let _t=null;const bt=()=>(new Date).getTime();var jt=class{constructor(t,{maxHeight:e,duration:i}){_t&&(_t.active=!1),this.type="jump",this.active=!0,this.t0=bt(),this.y0=t.y,this.y=t.y-e,this.duration=i,this.obj=t,_t=this,t.velocity.y=-Math.sqrt(2*t.acceleration.y*e)}update(){if(this.active){let{obj:t,y0:e,y:i,duration:n,t0:r}=this;(bt()-r>=1e3*n||t.y<=i)&&(this.active=!1)}}};const{max:kt}=Math;var Ot=({text:t,keyName:e,handler:i})=>J({color:"lime",children:[Z({text:t,color:"black",font:"30px monospace, sans-serif"}),Z({text:`[${e}]`,color:"black",font:"12px monospace, sans-serif"})],update:function(){const t=W(),n=this;let r=0,o=25;n.children.map(t=>{r=kt(r,t.width),t.x=(n.width-t.width)/2,t.y=o,o+=t.height+25}),n.width=r+50,n.height=o,n.x=(t.clientWidth-n.width)/2,n.y=(t.clientHeight-n.height)/2,dt(e)&&(n.ttl=0,i())}}),At=i(0),St=i.n(At),Pt=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function h(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){t.done?r(t.value):new i((function(e){e(t.value)})).then(s,h)}a((n=n.apply(t,e||[])).next())}))};const Et=(t,e,i,n,r)=>new Promise((o,s)=>{let h=document.createElement("canvas"),a=h.getContext("2d");h.width=n,h.height=r,a.drawImage(t,e,i,n,r,0,0,n,r);let c=new Image;c.src=h.toDataURL(),c.onload=()=>o(c),c.onerror=()=>s(c)});let Ht=new Image;Ht.src=St.a;let Mt,Rt,zt,Yt,It,Wt=null,Ct=null,Dt=null,Tt=new Promise((t,e)=>{Dt=t});Ht.onload=()=>Pt(void 0,void 0,void 0,(function*(){Wt=xt({image:Ht,frameWidth:220,frameHeight:210,animations:{walk:{frames:[0,1],loop:!0,frameRate:4}}}),Ct=xt({image:yield Et(Ht,0,220,220,120),frameWidth:110,frameHeight:140,animations:{flip:{frames:[0,1],frameRate:4}}}),Mt=yield Et(Ht,0,220,110,120),Rt=yield Et(Ht,0,0,220,210),zt=yield Et(Ht,220,210,220,210),Yt=yield Et(Ht,220,250,220,160),It=yield Et(Ht,0,340,110,140),Dt()}));const Lt=()=>{if(Wt)return Wt.animations},Ft=()=>{if(Ct)return Ct.animations},Xt=()=>Rt,Nt=()=>zt,Bt=()=>It,{abs:qt,min:Ut,max:Gt,random:$t}=Math,Kt=t=>{let{canvas:e,context:i,count:n,dt:r,messages:o}=t;const s=yt({create:J}),h=yt({create:()=>Z({x:0,y:0,text:""})}),a=e.clientWidth/n,c=e.clientHeight/n;return o=o||[],{pool:s,init:()=>{s.clear(),h.clear();for(let t=0;t<n;t++)for(let e=0;e<n;e++)s.get({x:t*a,y:e*c,width:a+1,height:c+1,color:"black",ttl:r+2*t+e*n});o.map(t=>h.get({x:0,y:0,font:"42px monospace, sans-serif",color:"white",text:t,ttl:r}))},update:()=>{s.update(),h.update();let t=0;h.getAliveObjects().map(i=>{i.y=t+5,t+=i.height,i.x=(e.clientWidth-i.width)/2})},render:()=>{s.render(),h.render()}}},{abs:Jt,min:Qt,max:Vt,random:Zt}=Math;var te=(t,e,i)=>{const n=t.clientWidth,r=t.clientHeight;Qt(n,r);let o=Z({text:"DEATH in HOLLIDAY",font:"42px monospace, sans-serif",color:"black",x:5,y:45,textAlign:"center"});o.x=(n-o.width)/2;let s=Ot({text:"To start press",handler:i,keyName:"enter"}),h=Xt(),a=h.naturalHeight/h.naturalWidth;h.height=r-4*o.height,h.width=h.height*a;let c=J({anchor:{x:.5,y:.5},x:h.width/2,y:r/2,width:h.width,height:h.height,image:h}),u=Nt();a=u.naturalHeight/u.naturalWidth,u.height=r-4*o.height,u.width=u.height*a;let l=J({anchor:{x:.5,y:.5},x:n-u.width/2+45,y:r/2,image:u});const d=gt({id:"start",objects:[o,s,c,l]}),f=Bt();f.width=f.height=25;const y=Mt;y.width=y.height=25;const p=Kt({canvas:t,context:e,count:20,dt:600,messages:["[CONTROLS]","[ arrow Up] ~ jump (max 3 jumps),","[ space ] throw coins"," ","[Story]","God is testing you... again","Youhave to save 100 souls!","Every misstake costs 1 coin","Every soul you miss costs 1 heart","[ENTER to start]"," ","Dedicated to my <3 son <3"]});return p.init(),{update:()=>{p.update(),o.x=(n-o.width)/2,s.x=n/2,s.y=(r-s.height)/2,d.update()},render:()=>{d.render(),p.render()}}};const{abs:ee,min:ie,max:ne,random:re,PI:oe}=Math;var se=(t,e,i,n)=>{const r=t.clientWidth,o=t.clientHeight;ie(r,o);let s=Z({text:3===i.status?"This is the END":"You WON my friend",font:"42px monospace, sans-serif",color:"black",x:5,y:45}),h=Z({text:3===i.status?"my UGLY friend":"this is the end",font:"42px monospace, sans-serif",color:"black",x:5,y:45}),a=Ot({text:"You may retry",handler:n,keyName:"space"}),c=Xt(),u=c.naturalHeight/c.naturalWidth;3===i.status?(c.height=(o-4*s.height)/2,c.width=c.height*u):(c.height=o-4*s.height,c.width=c.height*u);let l=Nt();u=l.naturalHeight/l.naturalWidth,l.height=o-4*s.height,l.width=l.height*u;let d=J({anchor:{x:.5,y:.5},x:r-l.width/2+45,y:o/2,width:l.width,height:l.height,image:l}),f=J({anchor:{x:.5,y:.5},x:45+c.width/2,y:3===i.status?o-c.height+50:o/2,image:c,rotation:3===i.status?-oe/2:0});const y=gt({id:"end",objects:[s,h,a,f,d]}),p=Kt({canvas:t,context:e,count:20,dt:10,messages:[]});return p.init(),{update:()=>{p.update(),s.x=(r-s.width)/2,h.x=(r-h.width)/2,h.y=s.y+2*s.height,y.update()},render:()=>{y.render(),p.render()}}};const he={},ae=(t,e)=>{he[t]=!1,lt([t],i=>{he[t]||(he[t]=!0,e(i))},{handler:"keydown"}),lt([t],e=>{he[t]=!1},{handler:"keyup"})},{max:ce,random:ue}=Math,le=yt({create:J});D(),ut();let de=W(),fe=C();de.width=document.body.clientWidth,de.height=document.body.clientHeight;const{abs:ye,min:pe,max:ve,random:ge}=Math,me={active:!0,jumping:!1,shooting:!1,jumps:3,round:0,status:1,coins:1,ghosts:0,failed:10};let we=Object.assign({},me);const xe=t=>{we=Object.assign({},we,t)};var _e;ae("arrowup",()=>{xe({jumping:!0})}),ae("space",()=>{xe({shooting:!0})}),_e=()=>{let t,e,i,n=de.clientWidth,r=de.clientHeight,o=pe(n,r),s=J({x:n/2-o/8/2,y:o/8*210/220,width:o/8,height:o/8*210/220,animations:Lt()});s.acceleration.y=.2;let h=Nt();h.width=o/4,h.height=o/4*210/220;let a=J({x:s.x+s.width/2,y:r-h.height-5,width:o/4,height:o/4*210/220,image:h,opacity:.8}),c=Yt;c.width=o/8,c.height=o/8*210/220;const u=yt({create:J,maxSize:10});let l=Z({text:""+we.coins,font:(o/16>>0)+"px monospace, sans-serif",color:"gold",x:5,y:5,textAlign:"center"}),d=J({x:l.x+l.width+5,y:5,width:o/16,height:o/16,animations:Ft()}),f=Z({text:""+we.ghosts,font:(o/16>>0)+"px monospace, sans-serif",color:"red",x:5+d.x+d.width,y:5,textAlign:"center"}),y=Bt();y.width=o/16,y.height=o/16+9;const p=J({y:5,x:5+f.x+f.width,width:o/16,height:o/16+9,image:y}),v=yt({create:J}),g=yt({create:J}),m=(t=>{let{clientWidth:e,clientHeight:i,width:n,count:r,onLoop:o}=t;return{init:()=>{le.clear();let t=0;for(let o=0;o<r;o++){let r=n+ue()*n>>0,s=o?5+n*ue()>>0:e,h=i/4+ue()*i/4>>0;le.get({x:t,y:i-h,width:s,height:15,color:"red",dx:-1,children:[J({x:0,y:15,width:s,height:i-15,color:"orange"})]}),t+=s+r}},update:()=>{le.update();let t=ce(...le.objects.map(t=>(t.color="red",t.x+t.width))),e=le.objects.findIndex(t=>t.x<-t.width),s=e>-1?le.objects[e]:void 0;s&&(s.x=t+n+ue()*n>>0,s.y=i-(i/4+ue()*i/4>>0)),e===r-1&&(o(),le.getAliveObjects().map(t=>t.dx-=1))},render:()=>{le.render()},map:t=>le.getAliveObjects().map(t),find:t=>le.getAliveObjects().find(t),findIndex:t=>le.getAliveObjects().findIndex(t),walls:()=>le.getAliveObjects().map(t=>t.children[0])}})({clientWidth:n,clientHeight:r,width:s.width,count:10,onLoop:()=>xe({round:we.round+1})});m.init();const w=J({x:0,y:7*r/8+15,width:n,height:r/8-15,color:"orange"});let x=[],_=null;et({update:()=>{if(3===we.status||4===we.status)t=null,e||(e=se(de,fe,we,()=>{xe({status:1})})),e.update();else if(1===we.status)t||(t=te(de,fe,()=>{xe(Object.assign({},me)),v.clear(),u.clear(),m.init(),s.y=0,xe({status:2})})),t.update(),e=null;else{if(t=null,e=null,s.update(),i&&i.update(),a.image.width=o/4,a.image.height=o/4*210/220,p.image.width=o/16,p.image.height=o/16+9,N(s,w)&&(xe({active:!1}),s.velocity.y=0,s.y=r-s.height,we.coins?i||(i=Ot({text:"Bail out: 1 coin",keyName:"enter",handler:()=>{we.coins>0&&(s.y=0,xe({active:!0,coins:we.coins-1,jumping:!1,jumps:me.jumps})),i=null}})):(xe({status:3,jumping:!1}),s.y=0)),!we.active)return;if(m.update(),d.update(),p.update(),v.update(),u.update(),g.update(),0===v.size&&6*ge()>5.5?v.get({x:n,y:ge()*r/4,width:o/16,height:o/16,animations:Ft(),ttl:1e3,dx:-2}).playAnimation("flip"):_=v.getAliveObjects()[0],_&&_.playAnimation("flip"),ge()>.8&&u.size<we.round){let t=5*ge();u.get({image:c,width:c.width,height:c.height,x:n,y:r/4+ge()*r/4,dx:-1-5*ge()>>0,rotation:360*ge()>>0,anchor:{x:.5,y:.5},scaleX:(t+5)/10,scaleY:(t+5)/10,opacity:.5+.5*ge()})}if(u.size){u.getAliveObjects().map(t=>{t.rotation+=Math.PI/180,t.x<0&&(t.ttl=0,xe({failed:we.failed-1}))});let t=u.getAliveObjects().filter(t=>g.getAliveObjects().find(e=>N(e,t)));t.length&&t.map(t=>{t.ttl=0,xe({ghosts:we.ghosts+1})})}g.size&&g.getAliveObjects().map(t=>{t.x>n&&(t.ttl=0)}),_&&N(_,s)&&(_.ttl=0,xe({coins:we.coins+1})),9===m.findIndex(t=>t.x<-t.width)&&xe({round:we.round+1}),m.map((t,e)=>{t.dx=-1-.2*we.round});let y=m.walls().find(t=>N(t,s));y||(y=m.find(t=>N(t,s)),y&&(xe({jumps:me.jumps}),s.velocity.y=0,s.y=y.y-s.height,y.color="green")),x=x.filter(t=>t.active),we.jumping&&we.jumps>0&&(xe({jumping:!1,jumps:we.jumps-1}),x.push(new jt(s,{maxHeight:r/4,duration:1/(we.round+1)}))),x.map(t=>t.update()),s.y<0&&(s.y=0),s.y>r-s.height&&(s.y=r-s.height),ye(s.velocity.y)>10&&(s.velocity.y=10*(0===(h=s.velocity.y)?0:h<1?-1:1)),l.text=""+we.coins,d.x=l.x+l.width+5,f.text=""+(we.ghosts+we.failed),f.x=15+d.x+d.width,p.x=f.x+f.width+5,s.playAnimation("walk"),we.shooting&&(we.coins&&(xe({coins:we.coins-1,jumps:me.jumps}),g.get({anchor:{x:.5,y:.5},x:s.x+s.width/2,y:s.y+s.height/2,dx:10,animations:Ft(),width:o/16,height:o/16})),xe({shooting:!1})),we.failed+we.ghosts<=0&&xe({status:3}),we.failed+we.ghosts>=20&&xe({status:4})}var h},render:()=>{3===we.status||4===we.status?e&&e.render():1===we.status?t&&t.render():(w.render(),v.render(),m.render(),s.render(),u.render(),d.render(),l.render(),p.render(),f.render(),a.render(),i&&i.render(),g.render())}}).start()},Pt(void 0,void 0,void 0,(function*(){Tt.then(_e)}))}]);